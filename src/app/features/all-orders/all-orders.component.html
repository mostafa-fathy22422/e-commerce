<section class="container min-h-screen dark:bg-gray-900">
  <div class="bg-white dark:bg-gray-900">
    <div class="mx-auto px-4 py-8 lg:pb-24">
      <div class="">
        <h1
          class="text-2xl font-bold tracking-tight text-gray-900 dark:text-white sm:text-3xl">{{ 'allOrders.Order history' | translate }}</h1>
      </div>
      <div class="mt-5">
        <div class=" ">
          @if (allOrders$ | async; as orders) {
            @if (orders.length > 0) {
              @for (order of orders; track order._id) {
                <div
                  class="rounded-lg mt-8 bg-gray-50 dark:bg-gray-800 px-4 py-6 sm:flex sm:items-center sm:justify-between sm:space-x-6 sm:px-6 lg:space-x-8">
                  <dl
                    class="flex-auto divide-y divide-gray-200 dark:divide-gray-700 text-sm text-gray-600 dark:text-gray-300 sm:grid sm:grid-cols-3 sm:gap-x-6 sm:divide-y-0 lg:w-1/2 lg:flex-none lg:gap-x-8">
                    <div class="max-sm:flex max-sm:justify-between max-sm:py-6 max-sm:first:pt-0 max-sm:last:pb-0">
                      <dt class="font-medium text-gray-900 dark:text-white">{{ 'allOrders.Date placed'| translate }}
                      </dt>
                      <dd class="sm:mt-1">
                        <time datetime="2021-01-22">{{ order.createdAt | date:'medium' }}</time>
                      </dd>
                    </div>
                    <div class="max-sm:flex max-sm:justify-between max-sm:py-6 max-sm:first:pt-0 max-sm:last:pb-0">
                      <dt class="font-medium text-gray-900 dark:text-white">{{ 'allOrders.Order number'| translate }}
                      </dt>
                      <dd class="sm:mt-1">{{ order.id }}</dd>
                    </div>
                    <div class="max-sm:flex max-sm:justify-between max-sm:py-6 max-sm:first:pt-0 max-sm:last:pb-0">
                      <dt class="font-medium text-gray-900 dark:text-white">{{ 'allOrders.Total amount'| translate }}
                      </dt>
                      <dd
                        class="font-medium text-gray-900 dark:text-white sm:mt-1">{{ order.totalOrderPrice | currency:'EGP ' }}
                      </dd>
                    </div>
                  </dl>
                </div>
                <table class=" w-full  text-gray-500 dark:text-gray-400 ">
                  <thead class="sr-only text-left text-sm text-gray-500 dark:text-gray-400 sm:not-sr-only">
                  <tr>
                    <th scope="col"
                        class="py-3 pe-8 font-normal sm:w-2/5 lg:w-1/3 ps-5 text-start">{{ 'allOrders.Product' | translate }}
                    </th>
                    <th scope="col"
                        class="hidden w-1/5 py-3 pe-8 font-normal sm:table-cell text-start">{{ 'allOrders.Total price' | translate }}
                    </th>
                    <th scope="col"
                        class="hidden py-3 pe-8 font-normal sm:table-cell text-center">{{ 'allOrders.Quantity' | translate }}
                    </th>
                    <th scope="col" class="w-0 py-3 text-end font-normal pe-5">{{ 'allOrders.Info' | translate }}</th>
                  </tr>
                  </thead>
                  @for (item of order?.cartItems ?? []; track item._id) {
                    <tbody class="divide-y divide-gray-200 border-b border-gray-200 text-sm sm:border-t">
                    <tr>
                      <td class="py-6 pe-8">
                        <div class="flex items-center">
                          <img
                            [src]="item.product?.imageCover"
                            [alt]="item.product?.title"
                            class="me-6 size-16 rounded-sm object-cover">
                          <div>
                            <div class="font-medium text-gray-900 dark:text-white">{{ item.product?.title }}</div>
                            <div class="mt-1 sm:hidden">{{ (item.price || 0) * item.count | currency:'EGP' }}</div>
                          </div>
                        </div>
                      </td>
                      <td class="hidden py-6 pe-8 sm:table-cell">{{ (item.price || 0) * item.count | currency:'EGP' }}
                      </td>
                      <td class="hidden py-6 pe-8 sm:table-cell text-center">{{ item.count }}</td>
                      <td class="py-6 text-end font-medium whitespace-nowrap">
                        <a
                          [routerLink]="['/product-details', item.product?.id, (item.product?.title || '').split(' ').join('-') .toLowerCase()]"
                          class="text-indigo-600 dark:text-indigo-400">
                          {{ 'allOrders.View'| translate }}<span
                          class="hidden lg:inline"> {{ 'allOrders.product' | translate }}</span></a>
                      </td>
                    </tr>
                    </tbody>
                  }
                </table>
              }
            }
          }
        </div>
      </div>
    </div>
  </div>

</section>
